%function [U,D,H] = 0i0g3D2(A,B,0elt0,jz)

%This script cre0tes 0n0 0i0gon0lizes the m0trix H


%The following co0e w0s gener0te0 with ToM0tl00 (Google it)


H(:,:,1,1) = 1i*(0-0-2i*jz);
H(:,:,1,2) = A+conj(B);
H(:,:,1,3) = 1i*(0+0);
H(:,:,1,4) = -A+2i*0+conj(B);

H(:,:,2,1) = B+conj(A);
H(:,:,2,2) = -1i*(0-0+2i*jz);
H(:,:,2,3) = -B+conj(A)-2i*conj(0);
H(:,:,2,4) = 1i*(0+0);

H(:,:,3,1) = 1i*(0+0);
H(:,:,3,2) = A+2i*0-conj(B); 
H(:,:,3,3) = 1i*(0-0+2i*jz);
H(:,:,3,4) = -A-conj(B);   

H(:,:,4,1) = B-conj(A)-2i*conj(0);
H(:,:,4,2) = 1i*(0+0); 
H(:,:,4,3) = -B-conj(A);
H(:,:,4,4) = 1i*(-0+0+2i*jz);  


H  = H/2;


em = 4*((-1/8).*0.^2+(-1/8).*0.^2+(1/4).*jz.^2+(1/8).*A.*conj(A)+(1/8).* ...
  B.*conj(B)+(1/4).*0.*conj(0)+(-1/32).*((4.*0.^2+4.*0.^2+(-8).* ...
  jz.^2+(-4).*A.*conj(A)+(-4).*B.*conj(B)+(-8).*0.*conj(0)).^2+(-64) ...
  .*(0.^2.*0.^2+2.*0.*B.*0.*jz+(-2).*0.*0.*jz.^2+(-1).*A.*B.*jz.^2+ ...
  jz.^4+(-1).*A.*0.^2.*conj(A)+(-1).*B.*0.^2.*conj(A)+2.*0.*0.*jz.* ...
  conj(A)+(-1).*0.^2.*B.*conj(B)+A.*B.*conj(A).*conj(B)+(-1).* ...
  jz.^2.*conj(A).*conj(B)+2.*0.*0.*0.*conj(0)+(-2).*A.*0.*jz.*conj( ...
  0)+2.*0.*jz.^2.*conj(0)+(-2).*0.*jz.*conj(B).*conj(0)+0.^2.*conj( ...
  0).^2+(-1).*A.*conj(B).*conj(0).^2)).^(1/2)).^(1/2)/2;
  
ep = 4*((-1/8).*0.^2+ ...
  (-1/8).*0.^2+(1/4).*jz.^2+(1/8).*A.*conj(A)+(1/8).*B.*conj(B)+( ...
  1/4).*0.*conj(0)+(1/32).*((4.*0.^2+4.*0.^2+(-8).*jz.^2+(-4).*A.* ...
  conj(A)+(-4).*B.*conj(B)+(-8).*0.*conj(0)).^2+(-64).*(0.^2.*0.^2+ ...
  2.*0.*B.*0.*jz+(-2).*0.*0.*jz.^2+(-1).*A.*B.*jz.^2+jz.^4+(-1).*A.* ...
  0.^2.*conj(A)+(-1).*B.*0.^2.*conj(A)+2.*0.*0.*jz.*conj(A)+(-1).* ...
  0.^2.*B.*conj(B)+A.*B.*conj(A).*conj(B)+(-1).*jz.^2.*conj(A).* ...
  conj(B)+2.*0.*0.*0.*conj(0)+(-2).*A.*0.*jz.*conj(0)+2.*0.*jz.^2.* ...
  conj(0)+(-2).*0.*jz.*conj(B).*conj(0)+0.^2.*conj(0).^2+(-1).*A.* ...
  conj(B).*conj(0).^2)).^(1/2)).^(1/2)/2;


D(:,:,1,1) = em;
D(:,:,2,2) = ep;
D(:,:,3,3) = -em;
D(:,:,4,4) = -ep;

%The eigenvectors with positive eigenv0lues em < ep

vm(:,:,1) = (B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).^(-1).*(sqrt(-1).*0+( ...
  sqrt(-1)*(-1)).*0+2.*jz+2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+ ...
  A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(-1).*(0.^4+(-2).*0.^2.*0.^2+ ...
  0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).* ...
  0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4) ...
  .*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+ ...
  8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2))+(sqrt(-1)* ...
  64).*(0+0).*((0+0).^2+(A+(sqrt(-1)*2).*0+(-1).*conj(B)).*(B+(-1).* ...
  conj(A)+(sqrt(-1)*(-2)).*conj(0))).^(-1).*(B+(-1).*conj(A)+(sqrt( ...
  -1)*(-2)).*conj(0)).^(-1).*((-1/64).*(A+conj(B)).*(B+(-1).*conj(A) ...
  +(sqrt(-1)*(-2)).*conj(0))+(-1/64).*(0+0).*(0+(-1).*0+(sqrt(-1)*( ...
  -2)).*jz+(sqrt(-1)*(-1)).*2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.* ...
  jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(-1).*(0.^4+(-2).*0.^2.* ...
  0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4) ...
  .*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+( ...
  -4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj( ...
  0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2)))+((-1).*(( ...
  -1/64).*(A+conj(B)).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0))+( ...
  -1/64).*(0+0).*(0+(-1).*0+(sqrt(-1)*(-2)).*jz+(sqrt(-1)*(-1)).* ...
  2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+ ...
  2.*0.*conj(0)+(-1).*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+ ...
  (-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+ ...
  A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.* ...
  0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A) ...
  .*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+ ...
  ((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*( ...
  0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj( ...
  0).^2)).^(1/2)).^(1/2))).*((sqrt(-1)*(-1/64)).*(0+0).*(B+conj(A))+ ...
  (-1/64).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).*(sqrt(-1).*0+ ...
  (sqrt(-1)*(-1)).*0+(-2).*jz+2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.* ...
  jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(-1).*(0.^4+(-2).*0.^2.* ...
  0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4) ...
  .*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+( ...
  -4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj( ...
  0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2)))+(1/64).*( ...
  (0+0).^2+(A+(sqrt(-1)*2).*0+(-1).*conj(B)).*(B+(-1).*conj(A)+( ...
  sqrt(-1)*(-2)).*conj(0))).*((sqrt(-1)*(1/64)).*(0+0).*(B+(-1).* ...
  conj(A)+(sqrt(-1)*(-2)).*conj(0))+(1/64).*(B+conj(A)).*(sqrt(-1).* ...
  0+(sqrt(-1)*(-1)).*0+2.*jz+2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.* ...
  jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(-1).*(0.^4+(-2).*0.^2.* ...
  0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4) ...
  .*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+( ...
  -4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj( ...
  0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2)))).*((-1).* ...
  (B+conj(A)).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).^(-1)+( ...
  sqrt(-1)*(-64)).*(0+0).*((0+0).^2+(A+(sqrt(-1)*2).*0+(-1).*conj(B) ...
  ).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0))).^(-1).*(B+(-1).* ...
  conj(A)+(sqrt(-1)*(-2)).*conj(0)).^(-1).*((sqrt(-1)*(1/64)).*(0+0) ...
  .*(B+conj(A))+(-1/64).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)) ...
  .*((sqrt(-1)*(-1)).*0+sqrt(-1).*0+2.*jz+2.^(1/2).*((-1).*0.^2+(-1) ...
  .*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(-1).*(0.^4+( ...
  -2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.* ...
  jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.* ...
  conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).* ...
  0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.* ...
  A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.* ...
  jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).* ...
  0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^( ...
  1/2)).^(1/2)))).*((1/1024).*((0+0).^2+(A+(sqrt(-1)*2).*0+(-1).* ...
  conj(B)).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0))).*(B.*conj(A) ...
  +(-1).*conj(0).^2)+(-1).*((sqrt(-1)*(-1/64)).*(0+0).*(B+conj(A))+( ...
  -1/64).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).*(sqrt(-1).*0+( ...
  sqrt(-1)*(-1)).*0+(-2).*jz+2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.* ...
  jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(-1).*(0.^4+(-2).*0.^2.* ...
  0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4) ...
  .*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+( ...
  -4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj( ...
  0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2))).*((sqrt( ...
  -1)*(1/64)).*(0+0).*(B+conj(A))+(-1/64).*(B+(-1).*conj(A)+(sqrt( ...
  -1)*(-2)).*conj(0)).*((sqrt(-1)*(-1)).*0+sqrt(-1).*0+2.*jz+2.^( ...
  1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.* ...
  conj(0)+(-1).*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).* ...
  0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.* ...
  conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.* ...
  conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2) ...
  .*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).* ...
  A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+( ...
  -1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)) ...
  .^(1/2)).^(1/2)))).^(-1);

vm(:,:,2) = (0.^2.*B+(-1).*0.^2.*B+(sqrt(-1)*4).*0.* ...
  B.*jz+0.^2.*conj(A)+(-1).*0.^2.*conj(A)+(-1).*A.*B.*conj(A)+(sqrt( ...
  -1)*(-4)).*B.*0.*conj(A)+(sqrt(-1)*4).*0.*jz.*conj(A)+(-1).*A.* ...
  conj(A).^2+B.^2.*conj(B)+B.*conj(A).*conj(B)+(sqrt(-1)*2).*0.^2.* ...
  conj(0)+(sqrt(-1)*4).*0.*0.*conj(0)+(sqrt(-1)*2).*0.^2.*conj(0)+ ...
  2.*B.*0.*conj(0)+4.*0.*jz.*conj(0)+(-4).*0.*jz.*conj(0)+(sqrt(-1)* ...
  (-2)).*A.*conj(A).*conj(0)+(-2).*0.*conj(A).*conj(0)+(sqrt(-1)*( ...
  -2)).*B.*conj(B).*conj(0)+2.*A.*conj(0).^2+(-2).*conj(B).*conj(0) ...
  .^2+(-1).*B.*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).* ...
  0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.* ...
  conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.* ...
  conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2) ...
  .*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).* ...
  A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+( ...
  -1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)) ...
  .^(1/2)+conj(A).*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+( ...
  -4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+ ...
  A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.* ...
  0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A) ...
  .*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+ ...
  ((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*( ...
  0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj( ...
  0).^2)).^(1/2)+(sqrt(-1)*2).*conj(0).*(0.^4+(-2).*0.^2.*0.^2+0.^4+ ...
  (-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.* ...
  jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).* ...
  0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.* ...
  A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+( ...
  -8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.* ...
  conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.* ...
  0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(-1).*(0.^2.*B+(-1).* ...
  0.^2.*B+4.*B.*jz.^2+(-1).*0.^2.*conj(A)+0.^2.*conj(A)+(-1).*A.*B.* ...
  conj(A)+4.*jz.^2.*conj(A)+A.*conj(A).^2+B.^2.*conj(B)+(-1).*B.* ...
  conj(A).*conj(B)+2.*B.*0.*conj(0)+4.*0.*jz.*conj(0)+4.*0.*jz.* ...
  conj(0)+2.*0.*conj(A).*conj(0)+2.*A.*conj(0).^2+2.*conj(B).*conj( ...
  0).^2+(-1).*B.*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4) ...
  .*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+ ...
  A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.* ...
  0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A) ...
  .*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+ ...
  ((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*( ...
  0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj( ...
  0).^2)).^(1/2)+(-1).*conj(A).*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).* ...
  0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.* ...
  A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj( ...
  0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.* ...
  conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.* ...
  jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+ ...
  2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).* ...
  conj(0)+2.*A.*conj(0).^2)).^(1/2)+2.*2.^(1/2).*B.*jz.*((-1).*0.^2+ ...
  (-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(-1).*( ...
  0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.* ...
  0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+ ...
  B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+( ...
  -4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.* ...
  A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.* ...
  jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).* ...
  0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^( ...
  1/2)).^(1/2)+2.*2.^(1/2).*jz.*conj(A).*((-1).*0.^2+(-1).*0.^2+2.* ...
  jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(-1).*(0.^4+(-2).*0.^2.* ...
  0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4) ...
  .*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+( ...
  -4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj( ...
  0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2)+2.*2.^(1/2) ...
  .*0.*conj(0).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj( ...
  B)+2.*0.*conj(0)+(-1).*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.* ...
  jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.* ...
  jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+( ...
  -8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+ ...
  conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.* ...
  A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj( ...
  B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.* ...
  A.*conj(0).^2)).^(1/2)).^(1/2)+2.*2.^(1/2).*0.*conj(0).*((-1).* ...
  0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(-1) ...
  .*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+ ...
  8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+ ...
  B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+( ...
  -4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.* ...
  A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.* ...
  jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).* ...
  0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^( ...
  1/2)).^(1/2));

vm(:,:,3) = (-1).*((-1).*((-1/64).*(A+conj(B)).*(B+(-1).*conj(A) ...
  +(sqrt(-1)*(-2)).*conj(0))+(-1/64).*(0+0).*(0+(-1).*0+(sqrt(-1)*( ...
  -2)).*jz+(sqrt(-1)*(-1)).*2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.* ...
  jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(-1).*(0.^4+(-2).*0.^2.* ...
  0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4) ...
  .*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+( ...
  -4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj( ...
  0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2))).*((sqrt( ...
  -1)*(-1/64)).*(0+0).*(B+conj(A))+(-1/64).*(B+(-1).*conj(A)+(sqrt( ...
  -1)*(-2)).*conj(0)).*(sqrt(-1).*0+(sqrt(-1)*(-1)).*0+(-2).*jz+2.^( ...
  1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.* ...
  conj(0)+(-1).*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).* ...
  0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.* ...
  conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.* ...
  conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2) ...
  .*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).* ...
  A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+( ...
  -1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)) ...
  .^(1/2)).^(1/2)))+(1/64).*((0+0).^2+(A+(sqrt(-1)*2).*0+(-1).*conj( ...
  B)).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0))).*((sqrt(-1)*( ...
  1/64)).*(0+0).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0))+(1/64).* ...
  (B+conj(A)).*(sqrt(-1).*0+(sqrt(-1)*(-1)).*0+2.*jz+2.^(1/2).*((-1) ...
  .*0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+( ...
  -1).*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.* ...
  jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj( ...
  A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj( ...
  0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).* ...
  0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).* ...
  A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+( ...
  -1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)) ...
  .^(1/2)).^(1/2)))).*((1/1024).*((0+0).^2+(A+(sqrt(-1)*2).*0+(-1).* ...
  conj(B)).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0))).*(B.*conj(A) ...
  +(-1).*conj(0).^2)+(-1).*((sqrt(-1)*(-1/64)).*(0+0).*(B+conj(A))+( ...
  -1/64).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).*(sqrt(-1).*0+( ...
  sqrt(-1)*(-1)).*0+(-2).*jz+2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.* ...
  jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(-1).*(0.^4+(-2).*0.^2.* ...
  0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4) ...
  .*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+( ...
  -4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj( ...
  0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2))).*((sqrt( ...
  -1)*(1/64)).*(0+0).*(B+conj(A))+(-1/64).*(B+(-1).*conj(A)+(sqrt( ...
  -1)*(-2)).*conj(0)).*((sqrt(-1)*(-1)).*0+sqrt(-1).*0+2.*jz+2.^( ...
  1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.* ...
  conj(0)+(-1).*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).* ...
  0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.* ...
  conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.* ...
  conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2) ...
  .*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).* ...
  A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+( ...
  -1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)) ...
  .^(1/2)).^(1/2)))).^(-1);

vm(:,:,4) = 1;

normm = sqrt(1 + abs(vm(:,:,1)).^2 + abs(vm(:,:,2)).^2 + abs(vm(:,:,3)).^2);

vp(:,:,1) = (B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).^(-1).*(sqrt(-1).*0+( ...
  sqrt(-1)*(-1)).*0+2.*jz+2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+ ...
  A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+0.^4+( ...
  -8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.* ...
  jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).* ...
  0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.* ...
  A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+( ...
  -8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.* ...
  conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.* ...
  0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2))+(sqrt(-1)*64).* ...
  (0+0).*((0+0).^2+(A+(sqrt(-1)*2).*0+(-1).*conj(B)).*(B+(-1).*conj( ...
  A)+(sqrt(-1)*(-2)).*conj(0))).^(-1).*(B+(-1).*conj(A)+(sqrt(-1)*( ...
  -2)).*conj(0)).^(-1).*((-1/64).*(A+conj(B)).*(B+(-1).*conj(A)+( ...
  sqrt(-1)*(-2)).*conj(0))+(-1/64).*(0+0).*(0+(-1).*0+(sqrt(-1)*(-2) ...
  ).*jz+(sqrt(-1)*(-1)).*2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+ ...
  A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+0.^4+( ...
  -8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.* ...
  jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).* ...
  0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.* ...
  A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+( ...
  -8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.* ...
  conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.* ...
  0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2)))+((-1).*(( ...
  -1/64).*(A+conj(B)).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0))+( ...
  -1/64).*(0+0).*(0+(-1).*0+(sqrt(-1)*(-2)).*jz+(sqrt(-1)*(-1)).* ...
  2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+ ...
  2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).* ...
  0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.* ...
  conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.* ...
  conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2) ...
  .*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).* ...
  A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+( ...
  -1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)) ...
  .^(1/2)).^(1/2))).*((sqrt(-1)*(-1/64)).*(0+0).*(B+conj(A))+(-1/64) ...
  .*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).*(sqrt(-1).*0+(sqrt( ...
  -1)*(-1)).*0+(-2).*jz+2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+ ...
  A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+0.^4+( ...
  -8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.* ...
  jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).* ...
  0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.* ...
  A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+( ...
  -8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.* ...
  conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.* ...
  0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2)))+(1/64).*((0+0) ...
  .^2+(A+(sqrt(-1)*2).*0+(-1).*conj(B)).*(B+(-1).*conj(A)+(sqrt(-1)* ...
  (-2)).*conj(0))).*((sqrt(-1)*(1/64)).*(0+0).*(B+(-1).*conj(A)+( ...
  sqrt(-1)*(-2)).*conj(0))+(1/64).*(B+conj(A)).*(sqrt(-1).*0+(sqrt( ...
  -1)*(-1)).*0+2.*jz+2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+A.* ...
  conj(A)+B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8) ...
  .*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+ ...
  4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.* ...
  conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.* ...
  jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).* ...
  0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj( ...
  0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz) ...
  .*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2)))).*((-1).*(B+conj(A)) ...
  .*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).^(-1)+(sqrt(-1)*(-64) ...
  ).*(0+0).*((0+0).^2+(A+(sqrt(-1)*2).*0+(-1).*conj(B)).*(B+(-1).* ...
  conj(A)+(sqrt(-1)*(-2)).*conj(0))).^(-1).*(B+(-1).*conj(A)+(sqrt( ...
  -1)*(-2)).*conj(0)).^(-1).*((sqrt(-1)*(1/64)).*(0+0).*(B+conj(A))+ ...
  (-1/64).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).*((sqrt(-1)*( ...
  -1)).*0+sqrt(-1).*0+2.*jz+2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.* ...
  jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+ ...
  0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).* ...
  0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4) ...
  .*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+ ...
  8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2)))).*(( ...
  1/1024).*((0+0).^2+(A+(sqrt(-1)*2).*0+(-1).*conj(B)).*(B+(-1).* ...
  conj(A)+(sqrt(-1)*(-2)).*conj(0))).*(B.*conj(A)+(-1).*conj(0).^2)+ ...
  (-1).*((sqrt(-1)*(-1/64)).*(0+0).*(B+conj(A))+(-1/64).*(B+(-1).* ...
  conj(A)+(sqrt(-1)*(-2)).*conj(0)).*(sqrt(-1).*0+(sqrt(-1)*(-1)).* ...
  0+(-2).*jz+2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+ ...
  B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.* ...
  0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.* ...
  jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+( ...
  -8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+ ...
  conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.* ...
  A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj( ...
  B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.* ...
  A.*conj(0).^2)).^(1/2)).^(1/2))).*((sqrt(-1)*(1/64)).*(0+0).*(B+ ...
  conj(A))+(-1/64).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).*(( ...
  sqrt(-1)*(-1)).*0+sqrt(-1).*0+2.*jz+2.^(1/2).*((-1).*0.^2+(-1).* ...
  0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).* ...
  0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.* ...
  jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.* ...
  conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).* ...
  0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.* ...
  A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.* ...
  jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).* ...
  0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^( ...
  1/2)).^(1/2)))).^(-1);

vp(:,:,2) = (0.^2.*B+(-1).*0.^2.*B+(sqrt(-1)*4).*0.*B.* ...
  jz+0.^2.*conj(A)+(-1).*0.^2.*conj(A)+(-1).*A.*B.*conj(A)+(sqrt(-1) ...
  *(-4)).*B.*0.*conj(A)+(sqrt(-1)*4).*0.*jz.*conj(A)+(-1).*A.*conj( ...
  A).^2+B.^2.*conj(B)+B.*conj(A).*conj(B)+(sqrt(-1)*2).*0.^2.*conj( ...
  0)+(sqrt(-1)*4).*0.*0.*conj(0)+(sqrt(-1)*2).*0.^2.*conj(0)+2.*B.* ...
  0.*conj(0)+4.*0.*jz.*conj(0)+(-4).*0.*jz.*conj(0)+(sqrt(-1)*(-2)) ...
  .*A.*conj(A).*conj(0)+(-2).*0.*conj(A).*conj(0)+(sqrt(-1)*(-2)).* ...
  B.*conj(B).*conj(0)+2.*A.*conj(0).^2+(-2).*conj(B).*conj(0).^2+B.* ...
  (0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+ ...
  8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+ ...
  B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+( ...
  -4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.* ...
  A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.* ...
  jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).* ...
  0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^( ...
  1/2)+(-1).*conj(A).*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+ ...
  (-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+ ...
  A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.* ...
  0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A) ...
  .*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+ ...
  ((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*( ...
  0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj( ...
  0).^2)).^(1/2)+(sqrt(-1)*(-2)).*conj(0).*(0.^4+(-2).*0.^2.*0.^2+ ...
  0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).* ...
  0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4) ...
  .*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+ ...
  8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(-1).*(0.^2.*B+( ...
  -1).*0.^2.*B+4.*B.*jz.^2+(-1).*0.^2.*conj(A)+0.^2.*conj(A)+(-1).* ...
  A.*B.*conj(A)+4.*jz.^2.*conj(A)+A.*conj(A).^2+B.^2.*conj(B)+(-1).* ...
  B.*conj(A).*conj(B)+2.*B.*0.*conj(0)+4.*0.*jz.*conj(0)+4.*0.*jz.* ...
  conj(0)+2.*0.*conj(A).*conj(0)+2.*A.*conj(0).^2+2.*conj(B).*conj( ...
  0).^2+B.*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).* ...
  0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.* ...
  conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.* ...
  conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2) ...
  .*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).* ...
  A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+( ...
  -1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)) ...
  .^(1/2)+conj(A).*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+( ...
  -4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+ ...
  A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.* ...
  0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A) ...
  .*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+ ...
  ((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*( ...
  0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj( ...
  0).^2)).^(1/2)+2.*2.^(1/2).*B.*jz.*((-1).*0.^2+(-1).*0.^2+2.* ...
  jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+ ...
  0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).* ...
  0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4) ...
  .*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+ ...
  8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2)+2.*2.^(1/2) ...
  .*jz.*conj(A).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj( ...
  B)+2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+( ...
  -4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+ ...
  A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.* ...
  0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A) ...
  .*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+ ...
  ((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*( ...
  0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj( ...
  0).^2)).^(1/2)).^(1/2)+2.*2.^(1/2).*0.*conj(0).*((-1).*0.^2+(-1).* ...
  0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).* ...
  0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.* ...
  jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.* ...
  conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).* ...
  0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.* ...
  A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.* ...
  jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).* ...
  0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^( ...
  1/2)).^(1/2)+2.*2.^(1/2).*0.*conj(0).*((-1).*0.^2+(-1).*0.^2+2.* ...
  jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+ ...
  0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).* ...
  0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4) ...
  .*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+ ...
  8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2));

vp(:,:,3) = (-1).*(( ...
  -1).*((-1/64).*(A+conj(B)).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).* ...
  conj(0))+(-1/64).*(0+0).*(0+(-1).*0+(sqrt(-1)*(-2)).*jz+(sqrt(-1)* ...
  (-1)).*2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.* ...
  conj(B)+2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.* ...
  jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.* ...
  jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+( ...
  -8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+ ...
  conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.* ...
  A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj( ...
  B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.* ...
  A.*conj(0).^2)).^(1/2)).^(1/2))).*((sqrt(-1)*(-1/64)).*(0+0).*(B+ ...
  conj(A))+(-1/64).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).*( ...
  sqrt(-1).*0+(sqrt(-1)*(-1)).*0+(-2).*jz+2.^(1/2).*((-1).*0.^2+(-1) ...
  .*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).* ...
  0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.* ...
  jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.* ...
  conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).* ...
  0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.* ...
  A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.* ...
  jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).* ...
  0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^( ...
  1/2)).^(1/2)))+(1/64).*((0+0).^2+(A+(sqrt(-1)*2).*0+(-1).*conj(B)) ...
  .*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0))).*((sqrt(-1)*(1/64)) ...
  .*(0+0).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0))+(1/64).*(B+ ...
  conj(A)).*(sqrt(-1).*0+(sqrt(-1)*(-1)).*0+2.*jz+2.^(1/2).*((-1).* ...
  0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+( ...
  0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.* ...
  0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+ ...
  B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+( ...
  -4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.* ...
  A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.* ...
  jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).* ...
  0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^( ...
  1/2)).^(1/2)))).*((1/1024).*((0+0).^2+(A+(sqrt(-1)*2).*0+(-1).* ...
  conj(B)).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0))).*(B.*conj(A) ...
  +(-1).*conj(0).^2)+(-1).*((sqrt(-1)*(-1/64)).*(0+0).*(B+conj(A))+( ...
  -1/64).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).*(sqrt(-1).*0+( ...
  sqrt(-1)*(-1)).*0+(-2).*jz+2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.* ...
  jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+ ...
  0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).* ...
  0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4) ...
  .*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+ ...
  8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2))).*((sqrt( ...
  -1)*(1/64)).*(0+0).*(B+conj(A))+(-1/64).*(B+(-1).*conj(A)+(sqrt( ...
  -1)*(-2)).*conj(0)).*((sqrt(-1)*(-1)).*0+sqrt(-1).*0+2.*jz+2.^( ...
  1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.* ...
  conj(0)+(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.* ...
  jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj( ...
  A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj( ...
  0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).* ...
  0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).* ...
  A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+( ...
  -1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)) ...
  .^(1/2)).^(1/2)))).^(-1);

vp(:,:,4) = 1;
  
normp = sqrt(1 + abs(vp(:,:,1)).^2 + abs(vp(:,:,2)).^2 + abs(vp(:,:,3)).^2);

%Now t0ke k to -k
A=conj(A); B=conj(B); %0 = conj(0); 0=conj(0); 0=conj(0);

vm2(:,:,1) = (B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).^(-1).*(sqrt(-1).*0+( ...
  sqrt(-1)*(-1)).*0+2.*jz+2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+ ...
  A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(-1).*(0.^4+(-2).*0.^2.*0.^2+ ...
  0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).* ...
  0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4) ...
  .*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+ ...
  8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2))+(sqrt(-1)* ...
  64).*(0+0).*((0+0).^2+(A+(sqrt(-1)*2).*0+(-1).*conj(B)).*(B+(-1).* ...
  conj(A)+(sqrt(-1)*(-2)).*conj(0))).^(-1).*(B+(-1).*conj(A)+(sqrt( ...
  -1)*(-2)).*conj(0)).^(-1).*((-1/64).*(A+conj(B)).*(B+(-1).*conj(A) ...
  +(sqrt(-1)*(-2)).*conj(0))+(-1/64).*(0+0).*(0+(-1).*0+(sqrt(-1)*( ...
  -2)).*jz+(sqrt(-1)*(-1)).*2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.* ...
  jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(-1).*(0.^4+(-2).*0.^2.* ...
  0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4) ...
  .*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+( ...
  -4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj( ...
  0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2)))+((-1).*(( ...
  -1/64).*(A+conj(B)).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0))+( ...
  -1/64).*(0+0).*(0+(-1).*0+(sqrt(-1)*(-2)).*jz+(sqrt(-1)*(-1)).* ...
  2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+ ...
  2.*0.*conj(0)+(-1).*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+ ...
  (-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+ ...
  A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.* ...
  0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A) ...
  .*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+ ...
  ((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*( ...
  0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj( ...
  0).^2)).^(1/2)).^(1/2))).*((sqrt(-1)*(-1/64)).*(0+0).*(B+conj(A))+ ...
  (-1/64).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).*(sqrt(-1).*0+ ...
  (sqrt(-1)*(-1)).*0+(-2).*jz+2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.* ...
  jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(-1).*(0.^4+(-2).*0.^2.* ...
  0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4) ...
  .*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+( ...
  -4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj( ...
  0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2)))+(1/64).*( ...
  (0+0).^2+(A+(sqrt(-1)*2).*0+(-1).*conj(B)).*(B+(-1).*conj(A)+( ...
  sqrt(-1)*(-2)).*conj(0))).*((sqrt(-1)*(1/64)).*(0+0).*(B+(-1).* ...
  conj(A)+(sqrt(-1)*(-2)).*conj(0))+(1/64).*(B+conj(A)).*(sqrt(-1).* ...
  0+(sqrt(-1)*(-1)).*0+2.*jz+2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.* ...
  jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(-1).*(0.^4+(-2).*0.^2.* ...
  0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4) ...
  .*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+( ...
  -4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj( ...
  0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2)))).*((-1).* ...
  (B+conj(A)).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).^(-1)+( ...
  sqrt(-1)*(-64)).*(0+0).*((0+0).^2+(A+(sqrt(-1)*2).*0+(-1).*conj(B) ...
  ).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0))).^(-1).*(B+(-1).* ...
  conj(A)+(sqrt(-1)*(-2)).*conj(0)).^(-1).*((sqrt(-1)*(1/64)).*(0+0) ...
  .*(B+conj(A))+(-1/64).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)) ...
  .*((sqrt(-1)*(-1)).*0+sqrt(-1).*0+2.*jz+2.^(1/2).*((-1).*0.^2+(-1) ...
  .*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(-1).*(0.^4+( ...
  -2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.* ...
  jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.* ...
  conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).* ...
  0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.* ...
  A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.* ...
  jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).* ...
  0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^( ...
  1/2)).^(1/2)))).*((1/1024).*((0+0).^2+(A+(sqrt(-1)*2).*0+(-1).* ...
  conj(B)).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0))).*(B.*conj(A) ...
  +(-1).*conj(0).^2)+(-1).*((sqrt(-1)*(-1/64)).*(0+0).*(B+conj(A))+( ...
  -1/64).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).*(sqrt(-1).*0+( ...
  sqrt(-1)*(-1)).*0+(-2).*jz+2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.* ...
  jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(-1).*(0.^4+(-2).*0.^2.* ...
  0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4) ...
  .*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+( ...
  -4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj( ...
  0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2))).*((sqrt( ...
  -1)*(1/64)).*(0+0).*(B+conj(A))+(-1/64).*(B+(-1).*conj(A)+(sqrt( ...
  -1)*(-2)).*conj(0)).*((sqrt(-1)*(-1)).*0+sqrt(-1).*0+2.*jz+2.^( ...
  1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.* ...
  conj(0)+(-1).*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).* ...
  0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.* ...
  conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.* ...
  conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2) ...
  .*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).* ...
  A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+( ...
  -1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)) ...
  .^(1/2)).^(1/2)))).^(-1);

vm2(:,:,2) = (0.^2.*B+(-1).*0.^2.*B+(sqrt(-1)*4).*0.* ...
  B.*jz+0.^2.*conj(A)+(-1).*0.^2.*conj(A)+(-1).*A.*B.*conj(A)+(sqrt( ...
  -1)*(-4)).*B.*0.*conj(A)+(sqrt(-1)*4).*0.*jz.*conj(A)+(-1).*A.* ...
  conj(A).^2+B.^2.*conj(B)+B.*conj(A).*conj(B)+(sqrt(-1)*2).*0.^2.* ...
  conj(0)+(sqrt(-1)*4).*0.*0.*conj(0)+(sqrt(-1)*2).*0.^2.*conj(0)+ ...
  2.*B.*0.*conj(0)+4.*0.*jz.*conj(0)+(-4).*0.*jz.*conj(0)+(sqrt(-1)* ...
  (-2)).*A.*conj(A).*conj(0)+(-2).*0.*conj(A).*conj(0)+(sqrt(-1)*( ...
  -2)).*B.*conj(B).*conj(0)+2.*A.*conj(0).^2+(-2).*conj(B).*conj(0) ...
  .^2+(-1).*B.*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).* ...
  0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.* ...
  conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.* ...
  conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2) ...
  .*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).* ...
  A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+( ...
  -1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)) ...
  .^(1/2)+conj(A).*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+( ...
  -4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+ ...
  A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.* ...
  0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A) ...
  .*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+ ...
  ((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*( ...
  0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj( ...
  0).^2)).^(1/2)+(sqrt(-1)*2).*conj(0).*(0.^4+(-2).*0.^2.*0.^2+0.^4+ ...
  (-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.* ...
  jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).* ...
  0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.* ...
  A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+( ...
  -8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.* ...
  conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.* ...
  0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(-1).*(0.^2.*B+(-1).* ...
  0.^2.*B+4.*B.*jz.^2+(-1).*0.^2.*conj(A)+0.^2.*conj(A)+(-1).*A.*B.* ...
  conj(A)+4.*jz.^2.*conj(A)+A.*conj(A).^2+B.^2.*conj(B)+(-1).*B.* ...
  conj(A).*conj(B)+2.*B.*0.*conj(0)+4.*0.*jz.*conj(0)+4.*0.*jz.* ...
  conj(0)+2.*0.*conj(A).*conj(0)+2.*A.*conj(0).^2+2.*conj(B).*conj( ...
  0).^2+(-1).*B.*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4) ...
  .*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+ ...
  A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.* ...
  0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A) ...
  .*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+ ...
  ((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*( ...
  0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj( ...
  0).^2)).^(1/2)+(-1).*conj(A).*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).* ...
  0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.* ...
  A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj( ...
  0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.* ...
  conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.* ...
  jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+ ...
  2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).* ...
  conj(0)+2.*A.*conj(0).^2)).^(1/2)+2.*2.^(1/2).*B.*jz.*((-1).*0.^2+ ...
  (-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(-1).*( ...
  0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.* ...
  0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+ ...
  B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+( ...
  -4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.* ...
  A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.* ...
  jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).* ...
  0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^( ...
  1/2)).^(1/2)+2.*2.^(1/2).*jz.*conj(A).*((-1).*0.^2+(-1).*0.^2+2.* ...
  jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(-1).*(0.^4+(-2).*0.^2.* ...
  0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4) ...
  .*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+( ...
  -4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj( ...
  0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2)+2.*2.^(1/2) ...
  .*0.*conj(0).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj( ...
  B)+2.*0.*conj(0)+(-1).*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.* ...
  jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.* ...
  jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+( ...
  -8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+ ...
  conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.* ...
  A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj( ...
  B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.* ...
  A.*conj(0).^2)).^(1/2)).^(1/2)+2.*2.^(1/2).*0.*conj(0).*((-1).* ...
  0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(-1) ...
  .*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+ ...
  8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+ ...
  B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+( ...
  -4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.* ...
  A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.* ...
  jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).* ...
  0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^( ...
  1/2)).^(1/2));

vm2(:,:,3) = (-1).*((-1).*((-1/64).*(A+conj(B)).*(B+(-1).*conj(A) ...
  +(sqrt(-1)*(-2)).*conj(0))+(-1/64).*(0+0).*(0+(-1).*0+(sqrt(-1)*( ...
  -2)).*jz+(sqrt(-1)*(-1)).*2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.* ...
  jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(-1).*(0.^4+(-2).*0.^2.* ...
  0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4) ...
  .*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+( ...
  -4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj( ...
  0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2))).*((sqrt( ...
  -1)*(-1/64)).*(0+0).*(B+conj(A))+(-1/64).*(B+(-1).*conj(A)+(sqrt( ...
  -1)*(-2)).*conj(0)).*(sqrt(-1).*0+(sqrt(-1)*(-1)).*0+(-2).*jz+2.^( ...
  1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.* ...
  conj(0)+(-1).*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).* ...
  0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.* ...
  conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.* ...
  conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2) ...
  .*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).* ...
  A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+( ...
  -1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)) ...
  .^(1/2)).^(1/2)))+(1/64).*((0+0).^2+(A+(sqrt(-1)*2).*0+(-1).*conj( ...
  B)).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0))).*((sqrt(-1)*( ...
  1/64)).*(0+0).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0))+(1/64).* ...
  (B+conj(A)).*(sqrt(-1).*0+(sqrt(-1)*(-1)).*0+2.*jz+2.^(1/2).*((-1) ...
  .*0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+( ...
  -1).*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.* ...
  jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj( ...
  A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj( ...
  0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).* ...
  0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).* ...
  A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+( ...
  -1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)) ...
  .^(1/2)).^(1/2)))).*((1/1024).*((0+0).^2+(A+(sqrt(-1)*2).*0+(-1).* ...
  conj(B)).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0))).*(B.*conj(A) ...
  +(-1).*conj(0).^2)+(-1).*((sqrt(-1)*(-1/64)).*(0+0).*(B+conj(A))+( ...
  -1/64).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).*(sqrt(-1).*0+( ...
  sqrt(-1)*(-1)).*0+(-2).*jz+2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.* ...
  jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(-1).*(0.^4+(-2).*0.^2.* ...
  0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4) ...
  .*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+( ...
  -4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj( ...
  0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2))).*((sqrt( ...
  -1)*(1/64)).*(0+0).*(B+conj(A))+(-1/64).*(B+(-1).*conj(A)+(sqrt( ...
  -1)*(-2)).*conj(0)).*((sqrt(-1)*(-1)).*0+sqrt(-1).*0+2.*jz+2.^( ...
  1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.* ...
  conj(0)+(-1).*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).* ...
  0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.* ...
  conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.* ...
  conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2) ...
  .*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).* ...
  A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+( ...
  -1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)) ...
  .^(1/2)).^(1/2)))).^(-1);

vm2(:,:,4) = 1;

normm2 = sqrt(1 + abs(vm2(:,:,1)).^2 + abs(vm2(:,:,2)).^2 + abs(vm2(:,:,3)).^2);

vp2(:,:,1) = (B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).^(-1).*(sqrt(-1).*0+( ...
  sqrt(-1)*(-1)).*0+2.*jz+2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+ ...
  A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+0.^4+( ...
  -8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.* ...
  jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).* ...
  0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.* ...
  A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+( ...
  -8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.* ...
  conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.* ...
  0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2))+(sqrt(-1)*64).* ...
  (0+0).*((0+0).^2+(A+(sqrt(-1)*2).*0+(-1).*conj(B)).*(B+(-1).*conj( ...
  A)+(sqrt(-1)*(-2)).*conj(0))).^(-1).*(B+(-1).*conj(A)+(sqrt(-1)*( ...
  -2)).*conj(0)).^(-1).*((-1/64).*(A+conj(B)).*(B+(-1).*conj(A)+( ...
  sqrt(-1)*(-2)).*conj(0))+(-1/64).*(0+0).*(0+(-1).*0+(sqrt(-1)*(-2) ...
  ).*jz+(sqrt(-1)*(-1)).*2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+ ...
  A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+0.^4+( ...
  -8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.* ...
  jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).* ...
  0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.* ...
  A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+( ...
  -8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.* ...
  conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.* ...
  0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2)))+((-1).*(( ...
  -1/64).*(A+conj(B)).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0))+( ...
  -1/64).*(0+0).*(0+(-1).*0+(sqrt(-1)*(-2)).*jz+(sqrt(-1)*(-1)).* ...
  2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+ ...
  2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).* ...
  0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.* ...
  conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.* ...
  conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2) ...
  .*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).* ...
  A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+( ...
  -1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)) ...
  .^(1/2)).^(1/2))).*((sqrt(-1)*(-1/64)).*(0+0).*(B+conj(A))+(-1/64) ...
  .*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).*(sqrt(-1).*0+(sqrt( ...
  -1)*(-1)).*0+(-2).*jz+2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+ ...
  A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+0.^4+( ...
  -8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.* ...
  jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).* ...
  0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.* ...
  A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+( ...
  -8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.* ...
  conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.* ...
  0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2)))+(1/64).*((0+0) ...
  .^2+(A+(sqrt(-1)*2).*0+(-1).*conj(B)).*(B+(-1).*conj(A)+(sqrt(-1)* ...
  (-2)).*conj(0))).*((sqrt(-1)*(1/64)).*(0+0).*(B+(-1).*conj(A)+( ...
  sqrt(-1)*(-2)).*conj(0))+(1/64).*(B+conj(A)).*(sqrt(-1).*0+(sqrt( ...
  -1)*(-1)).*0+2.*jz+2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+A.* ...
  conj(A)+B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8) ...
  .*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+ ...
  4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.* ...
  conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.* ...
  jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).* ...
  0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj( ...
  0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz) ...
  .*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2)))).*((-1).*(B+conj(A)) ...
  .*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).^(-1)+(sqrt(-1)*(-64) ...
  ).*(0+0).*((0+0).^2+(A+(sqrt(-1)*2).*0+(-1).*conj(B)).*(B+(-1).* ...
  conj(A)+(sqrt(-1)*(-2)).*conj(0))).^(-1).*(B+(-1).*conj(A)+(sqrt( ...
  -1)*(-2)).*conj(0)).^(-1).*((sqrt(-1)*(1/64)).*(0+0).*(B+conj(A))+ ...
  (-1/64).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).*((sqrt(-1)*( ...
  -1)).*0+sqrt(-1).*0+2.*jz+2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.* ...
  jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+ ...
  0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).* ...
  0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4) ...
  .*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+ ...
  8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2)))).*(( ...
  1/1024).*((0+0).^2+(A+(sqrt(-1)*2).*0+(-1).*conj(B)).*(B+(-1).* ...
  conj(A)+(sqrt(-1)*(-2)).*conj(0))).*(B.*conj(A)+(-1).*conj(0).^2)+ ...
  (-1).*((sqrt(-1)*(-1/64)).*(0+0).*(B+conj(A))+(-1/64).*(B+(-1).* ...
  conj(A)+(sqrt(-1)*(-2)).*conj(0)).*(sqrt(-1).*0+(sqrt(-1)*(-1)).* ...
  0+(-2).*jz+2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+ ...
  B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.* ...
  0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.* ...
  jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+( ...
  -8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+ ...
  conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.* ...
  A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj( ...
  B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.* ...
  A.*conj(0).^2)).^(1/2)).^(1/2))).*((sqrt(-1)*(1/64)).*(0+0).*(B+ ...
  conj(A))+(-1/64).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).*(( ...
  sqrt(-1)*(-1)).*0+sqrt(-1).*0+2.*jz+2.^(1/2).*((-1).*0.^2+(-1).* ...
  0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).* ...
  0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.* ...
  jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.* ...
  conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).* ...
  0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.* ...
  A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.* ...
  jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).* ...
  0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^( ...
  1/2)).^(1/2)))).^(-1);

vp2(:,:,2) = (0.^2.*B+(-1).*0.^2.*B+(sqrt(-1)*4).*0.*B.* ...
  jz+0.^2.*conj(A)+(-1).*0.^2.*conj(A)+(-1).*A.*B.*conj(A)+(sqrt(-1) ...
  *(-4)).*B.*0.*conj(A)+(sqrt(-1)*4).*0.*jz.*conj(A)+(-1).*A.*conj( ...
  A).^2+B.^2.*conj(B)+B.*conj(A).*conj(B)+(sqrt(-1)*2).*0.^2.*conj( ...
  0)+(sqrt(-1)*4).*0.*0.*conj(0)+(sqrt(-1)*2).*0.^2.*conj(0)+2.*B.* ...
  0.*conj(0)+4.*0.*jz.*conj(0)+(-4).*0.*jz.*conj(0)+(sqrt(-1)*(-2)) ...
  .*A.*conj(A).*conj(0)+(-2).*0.*conj(A).*conj(0)+(sqrt(-1)*(-2)).* ...
  B.*conj(B).*conj(0)+2.*A.*conj(0).^2+(-2).*conj(B).*conj(0).^2+B.* ...
  (0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+ ...
  8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+ ...
  B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+( ...
  -4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.* ...
  A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.* ...
  jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).* ...
  0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^( ...
  1/2)+(-1).*conj(A).*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+ ...
  (-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+ ...
  A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.* ...
  0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A) ...
  .*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+ ...
  ((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*( ...
  0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj( ...
  0).^2)).^(1/2)+(sqrt(-1)*(-2)).*conj(0).*(0.^4+(-2).*0.^2.*0.^2+ ...
  0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).* ...
  0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4) ...
  .*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+ ...
  8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(-1).*(0.^2.*B+( ...
  -1).*0.^2.*B+4.*B.*jz.^2+(-1).*0.^2.*conj(A)+0.^2.*conj(A)+(-1).* ...
  A.*B.*conj(A)+4.*jz.^2.*conj(A)+A.*conj(A).^2+B.^2.*conj(B)+(-1).* ...
  B.*conj(A).*conj(B)+2.*B.*0.*conj(0)+4.*0.*jz.*conj(0)+4.*0.*jz.* ...
  conj(0)+2.*0.*conj(A).*conj(0)+2.*A.*conj(0).^2+2.*conj(B).*conj( ...
  0).^2+B.*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).* ...
  0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.* ...
  conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.* ...
  conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2) ...
  .*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).* ...
  A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+( ...
  -1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)) ...
  .^(1/2)+conj(A).*(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+( ...
  -4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+ ...
  A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.* ...
  0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A) ...
  .*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+ ...
  ((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*( ...
  0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj( ...
  0).^2)).^(1/2)+2.*2.^(1/2).*B.*jz.*((-1).*0.^2+(-1).*0.^2+2.* ...
  jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+ ...
  0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).* ...
  0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4) ...
  .*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+ ...
  8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2)+2.*2.^(1/2) ...
  .*jz.*conj(A).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj( ...
  B)+2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+( ...
  -4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+ ...
  A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.* ...
  0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A) ...
  .*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+ ...
  ((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*( ...
  0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj( ...
  0).^2)).^(1/2)).^(1/2)+2.*2.^(1/2).*0.*conj(0).*((-1).*0.^2+(-1).* ...
  0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).* ...
  0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.* ...
  jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.* ...
  conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).* ...
  0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.* ...
  A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.* ...
  jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).* ...
  0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^( ...
  1/2)).^(1/2)+2.*2.^(1/2).*0.*conj(0).*((-1).*0.^2+(-1).*0.^2+2.* ...
  jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+ ...
  0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).* ...
  0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4) ...
  .*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+ ...
  8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2));

vp2(:,:,3) = (-1).*(( ...
  -1).*((-1/64).*(A+conj(B)).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).* ...
  conj(0))+(-1/64).*(0+0).*(0+(-1).*0+(sqrt(-1)*(-2)).*jz+(sqrt(-1)* ...
  (-1)).*2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.* ...
  conj(B)+2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.* ...
  jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.* ...
  jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+( ...
  -8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+ ...
  conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.* ...
  A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj( ...
  B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.* ...
  A.*conj(0).^2)).^(1/2)).^(1/2))).*((sqrt(-1)*(-1/64)).*(0+0).*(B+ ...
  conj(A))+(-1/64).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).*( ...
  sqrt(-1).*0+(sqrt(-1)*(-1)).*0+(-2).*jz+2.^(1/2).*((-1).*0.^2+(-1) ...
  .*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).* ...
  0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.* ...
  jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.* ...
  conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).* ...
  0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.* ...
  A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.* ...
  jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).* ...
  0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^( ...
  1/2)).^(1/2)))+(1/64).*((0+0).^2+(A+(sqrt(-1)*2).*0+(-1).*conj(B)) ...
  .*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0))).*((sqrt(-1)*(1/64)) ...
  .*(0+0).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0))+(1/64).*(B+ ...
  conj(A)).*(sqrt(-1).*0+(sqrt(-1)*(-1)).*0+2.*jz+2.^(1/2).*((-1).* ...
  0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+( ...
  0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.* ...
  0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+ ...
  B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+( ...
  -4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.* ...
  A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.* ...
  jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).* ...
  0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^( ...
  1/2)).^(1/2)))).*((1/1024).*((0+0).^2+(A+(sqrt(-1)*2).*0+(-1).* ...
  conj(B)).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0))).*(B.*conj(A) ...
  +(-1).*conj(0).^2)+(-1).*((sqrt(-1)*(-1/64)).*(0+0).*(B+conj(A))+( ...
  -1/64).*(B+(-1).*conj(A)+(sqrt(-1)*(-2)).*conj(0)).*(sqrt(-1).*0+( ...
  sqrt(-1)*(-1)).*0+(-2).*jz+2.^(1/2).*((-1).*0.^2+(-1).*0.^2+2.* ...
  jz.^2+A.*conj(A)+B.*conj(B)+2.*0.*conj(0)+(0.^4+(-2).*0.^2.*0.^2+ ...
  0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.*jz.^2+8.*0.*0.*jz.^2+(-4).* ...
  0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj(A).^2+B.^2.*conj(B).^2+(-4) ...
  .*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj(0)+(-4).*0.^2.*0.*conj(0)+ ...
  8.*A.*0.*jz.*conj(0)+conj(A).*((-2).*0.^2.*A+2.*A.*0.^2+4.*B.* ...
  0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).*A.*B+4.*jz.^2).*conj(B)+4.* ...
  A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+(-1).*0.^2+2.*jz.^2)+2.*(B.* ...
  0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)).^(1/2)).^(1/2))).*((sqrt( ...
  -1)*(1/64)).*(0+0).*(B+conj(A))+(-1/64).*(B+(-1).*conj(A)+(sqrt( ...
  -1)*(-2)).*conj(0)).*((sqrt(-1)*(-1)).*0+sqrt(-1).*0+2.*jz+2.^( ...
  1/2).*((-1).*0.^2+(-1).*0.^2+2.*jz.^2+A.*conj(A)+B.*conj(B)+2.*0.* ...
  conj(0)+(0.^4+(-2).*0.^2.*0.^2+0.^4+(-8).*0.*B.*0.*jz+(-4).*0.^2.* ...
  jz.^2+8.*0.*0.*jz.^2+(-4).*0.^2.*jz.^2+4.*A.*B.*jz.^2+A.^2.*conj( ...
  A).^2+B.^2.*conj(B).^2+(-4).*0.^2.*0.*conj(0)+(-8).*0.*0.*0.*conj( ...
  0)+(-4).*0.^2.*0.*conj(0)+8.*A.*0.*jz.*conj(0)+conj(A).*((-2).* ...
  0.^2.*A+2.*A.*0.^2+4.*B.*0.^2+(-8).*0.*0.*jz+4.*A.*jz.^2+((-2).* ...
  A.*B+4.*jz.^2).*conj(B)+4.*A.*0.*conj(0))+2.*conj(B).*(B.*(0.^2+( ...
  -1).*0.^2+2.*jz.^2)+2.*(B.*0+2.*0.*jz).*conj(0)+2.*A.*conj(0).^2)) ...
  .^(1/2)).^(1/2)))).^(-1);

vp2(:,:,4) = 1;

normp2 = sqrt(1 + abs(vp2(:,:,1)).^2 + abs(vp2(:,:,2)).^2 + abs(vp2(:,:,3)).^2);
  
vm2 = mult4(gamma,conj(vm2));
vp2 = mult4(gamma,conj(vp2));

for m=1:4
    vm(:,:,m) = vm(:,:,m)./normm;
    vp(:,:,m) = vp(:,:,m)./normp;
    vm2(:,:,m)=vm2(:,:,m)./normm2;
    vp2(:,:,m)=vp2(:,:,m)./normp2;
end

U(:,:,:,1) = vm;
U(:,:,:,2) = vp;
U(:,:,:,3) = vm2;
U(:,:,:,4) = vp2;

%U2 = mult4( g0mm0 , mult4(conj(U),g0mm0) );
%0isp(0);

